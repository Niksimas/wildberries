-- Создание базы данных для каталога звезд
-- PostgreSQL

-- Создание базы данных (выполнить от имени суперпользователя)
-- CREATE DATABASE *name_db*;

-- Подключиться к базе и выполнить следующие команды:

-- Удаление существующих таблиц (если нужно пересоздать)
DROP TABLE IF EXISTS stars CASCADE;
DROP TABLE IF EXISTS constellations CASCADE;
DROP TABLE IF EXISTS star_names CASCADE;

-- 1. Таблица созвездий
CREATE TABLE constellations (
                                id SERIAL PRIMARY KEY,
                                name VARCHAR(100) UNIQUE NOT NULL,
                                latin_name VARCHAR(100) UNIQUE NOT NULL,
                                abbreviation VARCHAR(10) UNIQUE,
                                created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP
);

-- 2. Таблица названий звезд
CREATE TABLE star_names (
                            id SERIAL PRIMARY KEY,
                            name VARCHAR(150) UNIQUE NOT NULL,
                            alternative_name VARCHAR(150),
                            catalog_designation VARCHAR(50), -- например, HD 48915, HIP 32349
                            created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP
);

-- 3. Основная таблица звезд
CREATE TABLE stars (
                       id SERIAL PRIMARY KEY,
                       star_name_id INTEGER REFERENCES star_names(id) ON DELETE CASCADE,
                       constellation_id INTEGER REFERENCES constellations(id) ON DELETE SET NULL,
                       distance_light_years DECIMAL(10,2) NOT NULL, -- расстояние в световых годах
                       solar_masses DECIMAL(8,3) NOT NULL, -- масса в массах Солнца
                       created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
                       CONSTRAINT positive_distance CHECK (distance_light_years > 0),
                       CONSTRAINT positive_mass CHECK (solar_masses > 0)
);

-- Создание индексов для быстрого поиска
CREATE INDEX idx_stars_distance ON stars(distance_light_years);
CREATE INDEX idx_stars_mass ON stars(solar_masses);
CREATE INDEX idx_star_names_name ON star_names(name);
CREATE INDEX idx_constellations_name ON constellations(name);

-- Наполнение таблицы созвездий
INSERT INTO constellations (name, latin_name, abbreviation) VALUES
    ('Большой Пёс', 'Canis Major', 'CMa'),
    ('Лира', 'Lyra', 'Lyr'),
    ('Центавр', 'Centaurus', 'Cen'),
    ('Орион', 'Orion', 'Ori'),
    ('Большая Медведица', 'Ursa Major', 'UMa'),
    ('Лев', 'Leo', 'Leo'),
    ('Близнецы', 'Gemini', 'Gem'),
    ('Малый Пёс', 'Canis Minor', 'CMi'),
    ('Эридан', 'Eridanus', 'Eri'),
    ('Возничий', 'Auriga', 'Aur'),
    ('Южный Крест', 'Crux', 'Cru'),
    ('Волк', 'Lupus', 'Lup'),
    ('Дева', 'Virgo', 'Vir'),
    ('Орёл', 'Aquila', 'Aql'),
    ('Лебедь', 'Cygnus', 'Cyg'),
    ('Телец', 'Taurus', 'Tau'),
    ('Южная Рыба', 'Piscis Austrinus', 'PsA'),
    ('Киль', 'Carina', 'Car'),
    ('Стрелец', 'Sagittarius', 'Sgr'),
    ('Паруса', 'Vela', 'Vel');

-- Наполнение таблицы названий звезд
INSERT INTO star_names (name, alternative_name, catalog_designation) VALUES
     ('Сириус', 'Альфа Большого Пса', 'HD 48915'),
     ('Канопус', 'Альфа Киля', 'HD 45348'),
     ('Арктур', 'Альфа Волопаса', 'HD 124897'),
     ('Вега', 'Альфа Лиры', 'HD 172167'),
     ('Капелла', 'Альфа Возничего', 'HD 34029'),
     ('Ригель', 'Бета Ориона', 'HD 34085'),
     ('Процион', 'Альфа Малого Пса', 'HD 61421'),
     ('Ахернар', 'Альфа Эридана', 'HD 10144'),
     ('Бетельгейзе', 'Альфа Ориона', 'HD 39801'),
     ('Альдебаран', 'Альфа Тельца', 'HD 29139'),
     ('Альфа Центавра A', 'Ригиль Кентаврус', 'HD 128620'),
     ('Альфа Центавра B', 'Толиман', 'HD 128621'),
     ('Спика', 'Альфа Девы', 'HD 116658'),
     ('Антарес', 'Альфа Скорпиона', 'HD 148478'),
     ('Поллукс', 'Бета Близнецов', 'HD 62509'),
     ('Фомальгаут', 'Альфа Южной Рыбы', 'HD 216956'),
     ('Денеб', 'Альфа Лебедя', 'HD 197345'),
     ('Регул', 'Альфа Льва', 'HD 87901'),
     ('Альтаир', 'Альфа Орла', 'HD 187642'),
     ('Кастор', 'Альфа Близнецов', 'HD 60179'),
     ('Гакрукс', 'Гамма Южного Креста', 'HD 108903'),
     ('Белатрикс', 'Гамма Ориона', 'HD 35468'),
     ('Эльнат', 'Бета Тельца', 'HD 35497'),
     ('Мирзам', 'Бета Большого Пса', 'HD 44743'),
     ('Альнилам', 'Эпсилон Ориона', 'HD 37128'),
     ('Альнитак', 'Дзета Ориона', 'HD 37742'),
     ('Минтака', 'Дельта Ориона', 'HD 36486'),
     ('Дубхе', 'Альфа Большой Медведицы', 'HD 95689'),
     ('Мерак', 'Бета Большой Медведицы', 'HD 95418'),
     ('Феб', 'Альфа Большой Медведицы', 'HD 116656');

-- Наполнение основной таблицы звезд (с реальными астрономическими данными)
INSERT INTO stars (star_name_id, constellation_id, distance_light_years, solar_masses) VALUES
-- Сириус - самая яркая звезда на небе
(1, 1, 8.66, 2.063),
-- Канопус - вторая по яркости звезда
(2, 18, 310.00, 8.50),
-- Арктур - красный гигант
(3, 5, 36.70, 1.08),
-- Вега - стандарт нулевой звездной величины
(4, 2, 25.04, 2.135),
-- Капелла - желтый гигант
(5, 10, 42.90, 2.69),
-- Ригель - голубой супергигант
(6, 4, 864.30, 18.00),
-- Процион - желто-белая звезда
(7, 8, 11.50, 1.499),
-- Ахернар - быстро вращающаяся звезда
(8, 9, 139.00, 6.78),
-- Бетельгейзе - красный супергигант
(9, 4, 642.50, 11.60),
-- Альдебаран - красный гигант
(10, 16, 65.30, 1.16),
-- Альфа Центавра A - ближайшая звезда солнечного типа
(11, 3, 4.37, 1.10),
-- Альфа Центавра B
(12, 3, 4.37, 0.91),
-- Спика - двойная звезда
(13, 13, 250.00, 10.25),
-- Антарес - красный супергигант
(14, 1, 604.00, 12.00),
-- Поллукс - оранжевый гигант
(15, 7, 33.78, 1.91),
-- Фомальгаут - молодая звезда
(16, 17, 25.13, 1.92),
-- Денеб - один из самых мощных супергигантов
(17, 15, 2615.00, 19.00),
-- Регул - быстро вращающаяся звезда
(18, 6, 79.30, 3.80),
-- Альтаир - одна из ближайших ярких звезд
(19, 14, 16.73, 1.79),
-- Кастор - сложная многократная система
(20, 7, 51.60, 2.76),
-- Гакрукс
(21, 11, 88.60, 1.50),
-- Белатрикс - голубой гигант
(22, 4, 244.60, 8.60),
-- Эльнат - голубой гигант
(23, 16, 131.00, 4.20),
-- Мирзам - голубой гигант
(24, 1, 499.00, 13.50),
-- Альнилам - голубой супергигант из пояса Ориона
(25, 4, 2000.00, 32.40),
-- Альнитак - голубая звезда из пояса Ориона
(26, 4, 1260.00, 28.00),
-- Минтака - голубая звезда из пояса Ориона
(27, 4, 915.00, 24.00),
-- Дубхе - оранжевый гигант
(28, 5, 123.00, 4.25),
-- Мерак - белая звезда
(29, 5, 79.40, 2.74),
-- Феб (пример дополнительной звезды)
(30, 5, 84.00, 2.94);
